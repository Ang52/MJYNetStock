# 仓储管理系统 - 快速启动指南

## 重要提示
如果遇到编译器崩溃错误(csc.exe退出代码-1073741819)，请尝试以下解决方案：

### 解决方案1：关闭并重新打开Visual Studio
```
1. 关闭Visual Studio
2. 删除 bin 和 obj 文件夹
3. 重新打开项目
4. 右键项目 -> 重新生成
```

### 解决方案2：清理解决方案
```bash
# 在项目目录下执行
rd /s /q bin
rd /s /q obj
dotnet clean
dotnet restore
dotnet build
```

### 解决方案3：使用命令行编译
```bash
# 导航到项目目录
cd D:\C#\MJYNetStock

# 清理项目
dotnet clean

# 还原依赖
dotnet restore

# 编译项目
dotnet build --no-incremental

# 运行项目
dotnet run
```

### 解决方案4：检查环境
```
1. 确保 .NET 8 SDK 已正确安装
2. 运行: dotnet --version (应显示 8.x.x)
3. 更新 Visual Studio 到最新版本
4. 重启计算机
```

## 数据库配置步骤

### 1. 启动MySQL服务
```bash
# Windows
net start MySQL80

# 或者通过服务管理器启动MySQL服务
```

### 2. 创建数据库并导入初始数据
```bash
# 方式1：使用命令行
mysql -u root -p

# 在MySQL命令行中执行
source D:/C#/MJYNetStock/Database/init.sql

# 方式2：使用MySQL Workbench
# 打开 Database/init.sql 文件并执行
```

### 3. 修改数据库连接配置
编辑文件: `Database/DbConfig.cs`
```csharp
public static string Server { get; set; } = "localhost";
public static string Port { get; set; } = "3306";
public static string Database { get; set; } = "mjynetstock";
public static string UserId { get; set; } = "root";
public static string Password { get; set; } = "你的MySQL密码";
```

## 首次运行

### 使用Visual Studio运行
```
1. 打开 MJYNetStock.sln
2. 等待NuGet包还原完成
3. 按 F5 或点击"开始"按钮
4. 如果出现编译错误，尝试上面的解决方案
```

### 使用命令行运行
```bash
cd D:\C#\MJYNetStock
dotnet run
```

## 登录系统

启动后会显示登录界面，使用以下账号登录：

**管理员账号：**
- 用户名：admin
- 密码：123456
- 权限：所有功能

**操作员账号：**
- 用户名：user
- 密码：123456
- 权限：除用户管理外的所有功能

## 主要功能使用流程

### 1. 设置基础数据
```
1. 登录系统
2. 点击"仓库管理" -> 添加仓库信息
3. 点击"物料管理" -> 添加物料信息
```

### 2. 入库操作
```
1. 点击"入库管理"
2. 选择物料和仓库
3. 输入数量和单价（金额自动计算）
4. 填写供应商信息
5. 点击"入库"按钮
```

### 3. 出库操作
```
1. 点击"出库管理"
2. 选择物料和仓库
3. 输入数量和单价（系统会检查库存）
4. 填写领用人信息
5. 点击"出库"按钮
```

### 4. 查询库存
```
1. 点击"库存查询"
2. 可按物资编号、名称、仓库查询
3. 点击"导出"可导出CSV格式数据
```

### 5. 查看报表
```
1. 点击"报表统计"
2. 选择年份和月份
3. 点击"查询"查看统计数据
4. 可查看月入库汇总、月出库汇总、当前库存
5. 点击"导出报表"可导出完整报表
```

## 常见问题排查

### 问题1：无法连接数据库
```
错误信息：Unable to connect to MySQL server

解决方法：
1. 检查MySQL服务是否启动
2. 确认连接参数（主机、端口、用户名、密码）
3. 测试MySQL连接：mysql -h localhost -P 3306 -u root -p
4. 检查防火墙设置
```

### 问题2：找不到数据库
```
错误信息：Unknown database 'mjynetstock'

解决方法：
1. 确认是否执行了init.sql脚本
2. 在MySQL中执行：SHOW DATABASES;
3. 如果没有mjynetstock数据库，重新执行init.sql
```

### 问题3：编译失败
```
错误信息：csc.exe exited with code -1073741819

解决方法：
1. 关闭Visual Studio
2. 删除bin和obj文件夹
3. 重新打开项目并重新生成
4. 或尝试使用命令行编译（见上文）
```

### 问题4：缺少MySql.Data包
```
错误信息：The type or namespace name 'MySql' could not be found

解决方法：
1. 在项目目录执行：dotnet restore
2. 或在Visual Studio中：右键项目 -> 管理NuGet程序包 -> 还原
```

### 问题5：登录失败
```
错误信息：用户名或密码错误

解决方法：
1. 确认是否使用默认账号：admin/123456
2. 检查users表是否有数据：SELECT * FROM mjynetstock.users;
3. 如果没有数据，重新执行init.sql
```

## 系统维护建议

### 定期备份
```bash
# 备份数据库
mysqldump -u root -p mjynetstock > backup_YYYYMMDD.sql

# 恢复数据库
mysql -u root -p mjynetstock < backup_YYYYMMDD.sql
```

### 性能优化
```
1. 定期清理过期的入库/出库记录
2. 为常用查询字段添加索引
3. 定期优化表：OPTIMIZE TABLE table_name;
```

### 数据安全
```
1. 定期修改默认密码
2. 禁用不需要的用户账号
3. 控制管理员账号数量
4. 定期检查系统日志
```

## 技术支持

如遇到无法解决的问题，请提供以下信息：
1. 错误截图或错误信息
2. 操作步骤
3. 系统环境（Windows版本、.NET版本、MySQL版本）
4. 数据库连接配置（脱敏后）

---

祝您使用愉快！
